<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: code | Nikhil Gupta]]></title>
  <link href="http://nikhgupta.com/blog/categories/code/atom.xml" rel="self"/>
  <link href="http://nikhgupta.com/"/>
  <updated>2014-01-31T04:01:10+05:30</updated>
  <id>http://nikhgupta.com/</id>
  <author>
    <name><![CDATA[Nikhil Gupta]]></name>
    <email><![CDATA[me@nikhgupta.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[wrapping long lines in ruby for display in source files]]></title>
    <link href="http://nikhgupta.com/code/wrapping-long-lines-in-ruby-for-display-in-source-files/"/>
    <updated>2014-01-31T02:42:00+05:30</updated>
    <id>http://nikhgupta.com/code/wrapping-long-lines-in-ruby-for-display-in-source-files</id>
    <content type="html"><![CDATA[<p>While working on a gem, I needed to generate ruby classes on the fly. Yeah,
I know this should never be the case, unless I needed around 600+ classes (I was
converting schema.org schemas to ruby classes).</p>

<p>Now, this required me to add descriptive text inside these classes, but the text
was very long and I hated how the text overflowed the screen. I use vim, which
promptly highlights the 80-char column marker on my source files, and I wanted
this text to stick to that. Effectively, I wanted something like the following:</p>

<p>```ruby
module MyModule
  class MyClass</p>

<pre><code>describes "A really long text that respects the 80-char column marker and
wraps nicely when it exceeds this length."
</code></pre>

<p>  end
end
```</p>

<!-- more -->


<p>I knew that Rails provided a nearly similar method with the name <code>word_wrap</code>,
and I tweaked it a bit to this:</p>

<p>```ruby
class String
  def wrap options = {}</p>

<pre><code>width = options.fetch(:width, 76)
self.strip.split("\n").collect do |line|
  line.length &gt; width ? line.gsub(/(.{1,#{width}})(\s+|$)/, "\\1\n") : line
end.map(&amp;:strip).join("\n")
</code></pre>

<p>  end</p>

<p>  def indent options = {}</p>

<pre><code>spaces = " " * options.fetch(:spaces, 4)
self.gsub(/^/, spaces).gsub(/^\s*$/, '')
</code></pre>

<p>  end</p>

<p>  def indent_with_wrap options = {}</p>

<pre><code>spaces = options.fetch(:spaces, 4)
width  = options.fetch(:width, 80)
width  = width &gt; spaces ? width - spaces : 1
self.wrap(width: width).indent(spaces: spaces)
</code></pre>

<p>  end
end
```</p>

<p>The last method, i.e. <code>indent_with_wrap</code> is what I am interested in, really.
Now, this might not be the best implementation for what I want, but it works and
is self-explanatory to me.</p>

<p>So, now, I can create my ERB template like this to get the desired results:</p>

<p>```ruby
module &lt;%= module_name %>
  class &lt;%= class_name %></p>

<pre><code>&lt;%= "describes #{description}".indent_with_wrap spaces: 4, width: 80 %&gt;
</code></pre>

<p>  end
end
```</p>

<p>This makes me a happy panda :)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[wish yourself a happy new year]]></title>
    <link href="http://nikhgupta.com/code/wish-yourself-a-happy-new-year/"/>
    <updated>2014-01-01T01:19:00+05:30</updated>
    <id>http://nikhgupta.com/code/wish-yourself-a-happy-new-year</id>
    <content type="html"><![CDATA[<blockquote><p>Well, before you do that, I will do it from my side: <code>Happy new year to you!</code></p></blockquote>

<p>So, I was just working on somethings, and found this nice little code snippet
that was totally appropriate for this event.</p>

<!-- more -->


<h2>Ruby</h2>

<p>If you are a fan of the ruby (like me), define a function with the following
definition (try, using <code>irb</code> for this purpose):</p>

<p><code>ruby
def encode(str); str.chars.map(&amp;:ord).inject(:+); end
</code></p>

<p>The above function does the following:</p>

<ul>
<li>accept a string as an input</li>
<li>break it into its constituent characters</li>
<li>convert these characters to their ascii integer value</li>
<li>sum up all the integer values and return that sum</li>
</ul>


<p>Nothin' great about that function, right?<br/>
Now, try this in your <code>irb</code> session:</p>

<p><code>ruby
encode "Happy new year to you!"
</code></p>

<p>You will see that the above function is quite intelligent in itself.</p>

<blockquote><p>That little function is empowered with an artificial intelligence by its code,
without any complex mechanisms :)</p></blockquote>

<p>Oh, and here is an alternative:</p>

<p><code>ruby
Happy = Time
Happy.new.year
</code></p>

<h2>Python</h2>

<p>If you are a python fan, instead, try this:</p>

<p><code>python
encode = lambda str: sum(ord(c) for c in str)
encode("Happy new year to you!")
</code></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Custom Domains on Github Pages without fucking up your Emails]]></title>
    <link href="http://nikhgupta.com/code/custom-domains-on-github-pages-without-fucking-up-your-emails/"/>
    <updated>2013-10-27T16:18:00+05:30</updated>
    <id>http://nikhgupta.com/code/custom-domains-on-github-pages-without-fucking-up-your-emails</id>
    <content type="html"><![CDATA[<p>As stated in my post titled <a href="/personal/back-with-a-bang/">Back with a Bang!</a>
(that title, still, amuses me), I have moved from
<a href="http://wordpress.org">WordPress</a> to using <a href="http://octopress.org">Octopress</a> on
Github pages. I was happy with my new blogging configuration, and I think, I am
on schedule with my post updates, till date. However, in making the switch,
I messed up my email configuration while setting up custom domain for this blog.
And, I was not even aware my emails were bouncing off, silently.</p>

<!-- more -->


<p>The <code>nikhgupta.com</code> domain is registered on <a href="http://namecheap.com">Namecheap</a>
(which has been my reliable domain manager, since the very start), and is hosted
on <a href="http://digitalocean.com">DigitalOcean</a> (which is an amazin' host and my
recommendation, these days). I am using <a href="http://zpanelcp.com">ZPanel</a>, since
cPanel is not a necessity for me (I would, rather, install the bare minimum on
my servers).</p>

<p>I must say that this silent bouncing of my emails was my own idiocy, and
therefore, I am writing this post to help anyone who may have gone through the
same.</p>

<h2>Custom Domain on Github Pages</h2>

<p>This has, already, been discussed on <a href="https://help.github.com/articles/setting-up-a-custom-domain-with-pages">this Github Help page</a>,
and therefore, I will not go in details. For summary:</p>

<ul>
<li>Create a repository on GitHub with the name of <code>username.github.com</code>.</li>
<li>Next, clone the Octopress (or Jekyll) repository, and make changes, as
required. My source for the website is in <code>source</code> branch, which is pushed to
the same branch on Github, while my website (real HTML pages) are pushed to
the <code>master</code> branch on Github. This is all managed by Octopress, by default.</li>
<li>Once we push the site (or run <code>bundle exec rake gen_deploy</code> if using
Octopress), our site will be viewable at <code>http://username.github.com</code>.</li>
<li>Next, we add a file named <code>CNAME</code> to our <code>source</code> directory. This file is
a simple text file that just contains one line, the domain name you wish to
use. In my case, <code>nikhgupta.com</code>.</li>
<li>Change the DNS settings for your domain to point to GitHubâ€™s servers. Since,
I was using the root domain name, I had to create <code>A</code> records for the <code>@</code> and
<code>www</code> entries, and point them to Github&rsquo;s IP (<code>204.232.175.78</code>).</li>
</ul>


<h2>Ensuring that Email configuration works</h2>

<p>Did you notice that last step? This is where I messed up my email
configuration. The <code>MX</code> records in my DNS settings for this domain, were
pointing to <code>mail.nikhgupta.com</code>, which in turn was pointing to <code>@</code> entry.</p>

<p>Now, that is what is wrong! The <code>@</code> entry was initially pointing to my server&rsquo;s
IP address, which meant that the incoming mails were being processed by my
server.</p>

<p>When I changed the <code>@</code> entry to point to Github&rsquo;s server, I made Github
responsible for managing my mails. Shit! Here is a snapshot for the change,
I made:</p>

<p><img class="center" src="/images/nikhgupta-dns-a-records-digitalocean.png"></p>

<p>Anyways, now, that I am aware of what is wrong, it is a simple fix. I made the
<code>MX</code> records to point to <code>mail.nikhgupta.com</code> (this was the default), but also
made <code>mail</code> A-record to point to my server&rsquo;s IP address (by adding an <code>A</code>
record).</p>

<p>Below are snapshots for my <code>A</code> and <code>MX</code> records, in their current state:</p>

<p><img class="center" src="/images/nikhgupta-dns-a-records.png">
<img class="center" src="/images/nikhgupta-dns-mx-records.png"></p>

<p>Finally, since I am using DigitalOcean server, I also needed to point the same
A-record to the server&rsquo;s IP using the management console provided by
DigitalOcean.</p>

<p>Now, I only had to wait to let the DNS propogate, and my emails were right back
to where they belonged. :)</p>

<p><strong>Update (05.11.2013)</strong>: It seems that I also needed to point out <code>MX</code> record
inside DigitalOcean&rsquo;s DNS settings to <code>mail.nikhgupta.com.</code> to make this all
work.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Finally. A self-hosted Gitlab instance!]]></title>
    <link href="http://nikhgupta.com/code/finally-a-self-hosted-gitlab-instance/"/>
    <updated>2013-10-26T13:26:00+05:30</updated>
    <id>http://nikhgupta.com/code/finally-a-self-hosted-gitlab-instance</id>
    <content type="html"><![CDATA[<p>Alright. I seem to be pretty happy today. I think any stupid developer, like me,
would be in the given circumstances. If you are aware about the existance of
a very nifty witchcraft named <a href="http://github.com">Github</a>, then, I am sure you
will be equally happy for me.</p>

<p><strong>Github is magic</strong>. <em>A protective one.</em></p>

<p>For those unaware, Github is a code hosting platform. It allows me to write my
code and then, keep it safe and versioned in their platform. That way, my code
is always there for me. I can share code with other developers, as well as
<em>fork</em> their work and modify it, locally. And, so on. The cool thing is that the
service is really amazing and free for open-source projects.</p>

<!-- more -->


<p>However, there are times when a person needs some privacy, even with the code,
he writes. Especially, with the code, he writes. I, often, used Github&rsquo;s private
repositories for this purpose. But, with a recent project, I was aiming to
create around 100 different private repositories, which was a bit unmanageable
with Github. I know, I know. I must not need that much private repositories.
But, what can I do about it if the project specification itself demand for the
same.</p>

<p>Therefore, I began looking at private repository hosts, and
<a href="http://bitbucket.org">BitBucket</a> seemed to be off, for some reasons. Finally,
I settled on using <a href="http://gitlab.org">GitlabHQ</a> for my purposes. It offered
everything Github had to offer, and more. More in the sense, that I can host
things privately on my own server. Perfect.</p>

<p>And, since I was already using <a href="http://digitalocean.com">DigitalOcean</a> for
hosting my server, and was using Ubuntu 12.10 as my operating system, it became
really easy to install Gitlab on my server. Followed <a href="https://www.digitalocean.com/community/articles/how-to-set-up-gitlab-as-your-very-own-private-github-clone">this
tutorial</a>
from DigitialOcean&rsquo;s community tutorials, and I was up and running with my own
private repository server.</p>

<p>I was, further, planning to install <a href="http://gitlab.org/gitlab-ci">Gitlab CI</a> on
my server, but that seemed to be an overkill, since I do not think I will need
continuous integration for my private projects, and for public projects, we have
another awesome witchcraft named <a href="http://travis-ci.org">Travis CI</a>.</p>

<p>O'course, you can test drive this on <a href="http://git.wickeddevelopers.com">Git @WickedDevelopers</a>.  <br/>
Happy, code browsing!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[managing your scripts should not be that hard]]></title>
    <link href="http://nikhgupta.com/personal/code/managing-your-scripts-should-not-be-that-hard/"/>
    <updated>2013-10-23T01:46:00+05:30</updated>
    <id>http://nikhgupta.com/personal/code/managing-your-scripts-should-not-be-that-hard</id>
    <content type="html"><![CDATA[<p>I am, often, found creating simple scripts to automate one or the other part of
my life. Most of the times, I would use a combination of project managers, task
managers, automation tools, and so on to do the tedious work for me. But, at the
other times, it is simply so much more easier to give my inner geek a kick in
the butt and start writing some code which will explicitely be used by me to
handle such one off tasks.</p>

<!-- more -->


<h2>The Problem</h2>

<p>But, here comes the irony, no matter what I try, I end up either misplacing
these little snippets of code, or otherwise it becomes so much tedious to
collect and keep them in an organized manner. Not to mention, the really
annoying part of creating aliases to these nice snippets and then, forgetting
what aliases you, currently, have. Oh, did I mention, I have to keep them online
in a Git repository, so that they are always versioned and sharing them is easy?
And, what if I am booting a new server or working on some other one-time
machine, it would kill me to do a clone of this repository, and then run them
via their full paths, and what if the script does not work on this new machine,
or what if I had to leave meanwhile?</p>

<p>Let me have a quick answer: it is not the 1990s, where the above issues
classified as a GNU license, and nor it is the 2000&rsquo;s, when I did not know how
to create an app dedicated for my own purposes.</p>

<h2>The Solution</h2>

<p>The solution? It&rsquo;s easy. Search for an existing solution or roll out our own.
Unfortunately, I was unable to find an existing solution (or, atleast, I will
pretend the same), and therefore will be rolling out my own, with the following
features:</p>

<ul>
<li>Has a client side gem that can be used to list a user&rsquo;s scripts, and allow him
to copy them in a folder on his machine, and assign aliases to these scripts
on the go.</li>
<li>The gem should be able to search for scripts based on some keywords.</li>
<li>User should be able to have CRUD rights over their scripts. They should be
able to share these scripts, as well as export them. They should be able to
reference another script inside the script they are creating.</li>
<li>All the scripts would be created use Github Gists, and hence, be versioned.</li>
<li>The application should provide an interface to write (and, probably, test) the
scripts on the server, itself. Provide a dedicated backend to the user?</li>
<li>The users should be able to run the scripts on their server via the app
interface, once they have the SSH authentication established? This is not as
straight-forward, since the app server will be the one connecting to the
user&rsquo;s server and hence, it is not safe.</li>
<li>Scripts should have a unique programming structure, which identifies their
requirements and alike, and notifies the user about the same.</li>
<li>Logging should be done on cloud for output of the scripts.</li>
<li>Scripts should be marked as safe based on their MD5 hash, kinda like thor
does for its installed scripts.</li>
<li>Scripts should be intelligent in telling the user when the runtime is not
available, e.g. the user tries to run a ruby script on a server with no-ruby
installed.</li>
</ul>

]]></content>
  </entry>
  
</feed>
